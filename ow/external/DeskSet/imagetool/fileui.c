#ifndef lint
static char sccsid[] = "@(#)fileui.c 1.21 93/03/31";
#endif

/*
 * Copyright (c) 1986, 1987, 1988 by Sun Microsystems, Inc.
 */

/*
 * fileui.c - User interface object initialization functions
 * for open/openas/save/saveas pop ups.
 * This file was generated by `gxv' from `imagetool.G'.
 */

#include <sys/param.h>
#include <xview/xview.h>
#include <xview/panel.h>
#include "imagetool.h"
#include "ui_imagetool.h"

int	panel_x_gap;
int	panel_y_gap;

/*
 * Initialize an instance of object `openf'.
 */
OpenObjects *
OpenObjectsInitialize(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	if (!ip && !(ip = (OpenObjects *) calloc(1, sizeof (OpenObjects))))
		return (OpenObjects *) NULL;
	if (!ip->open)
		ip->open = open_open_create(ip, owner);
	if (!ip->controls)
		ip->controls = open_controls_create(ip, ip->open);
	if (!ip->directory)
		ip->directory = open_directory_create(ip, ip->controls);
	if (!ip->file)
		ip->file = open_file_create(ip, ip->controls);
	if (!ip->open_button)
		ip->open_button = open_open_button_create(ip, ip->controls);
	return ip;
}

/*
 * Create object `open' in the specified instance.
 */
Xv_opaque
open_open_create(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, FRAME_CMD,
		XV_KEY_DATA, INSTANCE, ip,
		XV_WIDTH, 396,
		XV_HEIGHT, 86,
		XV_LABEL, LGET("Image Tool:  Open"),
		XV_SHOW, FALSE,
		FRAME_SHOW_FOOTER, TRUE,
		FRAME_SHOW_RESIZE_CORNER, FALSE,
		FRAME_CMD_PUSHPIN_IN, FALSE,
#ifdef OW_I18N
		WIN_USE_IM, TRUE,
#endif
		NULL);
	/*xv_set(xv_get(obj, FRAME_CMD_PANEL), WIN_SHOW, FALSE, NULL); */
	return obj;
}

/*
 * Create object `controls' in the specified instance.
 */
Xv_opaque
open_controls_create(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
        obj = xv_get( owner, FRAME_CMD_PANEL );
	xv_set( obj,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 0,
		XV_Y, 0,
		XV_WIDTH, WIN_EXTEND_TO_EDGE,
		XV_HEIGHT, WIN_EXTEND_TO_EDGE,
		WIN_BORDER, FALSE,
                XV_HELP_DATA, "imagetool:Open",
		NULL);
        panel_x_gap = xv_get( obj, PANEL_ITEM_X_GAP );
	return obj;
}

/*
 * Create object `directory' in the specified instance.
 */
Xv_opaque
open_directory_create(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 16,
		XV_Y, 16,
		PANEL_VALUE_DISPLAY_LENGTH, 35,
		PANEL_VALUE_STORED_LENGTH, MAXPATHLEN,
		PANEL_LABEL_STRING, LGET ("Directory:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
                XV_HELP_DATA, "imagetool:OpenDirectory",
		NULL);
	return obj;
}

/*
 * Create object `file' in the specified instance.
 */
Xv_opaque
open_file_create(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	extern void	open_file ();
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 56,
		XV_Y, 40,
		PANEL_VALUE_DISPLAY_LENGTH, 35,
		PANEL_VALUE_STORED_LENGTH, 80,
		PANEL_LABEL_STRING, LGET ("File:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
		PANEL_NOTIFY_LEVEL, PANEL_SPECIFIED,
		PANEL_NOTIFY_STRING, "\r\n",
                PANEL_NOTIFY_PROC, open_file,
                XV_HELP_DATA, "imagetool:OpenFile",
		NULL);
	return obj;
}

/*
 * Create object `open_button' in the specified instance.
 */
Xv_opaque
open_open_button_create(ip, owner)
	OpenObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	extern void	open_file ();
	
	obj = xv_create(owner, PANEL_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 176,
		XV_Y, 64,
		PANEL_LABEL_STRING, LGET ("Open"),
		PANEL_NOTIFY_PROC, open_file, 
                XV_HELP_DATA, "imagetool:OpenButton",
		NULL);
	return obj;
}

static void
attach_directories (obj)
    Xv_opaque  obj;
{
    static        attached = FALSE;
    char         *ow;
    char          dir1[MAXPATHLEN];
    char          dir2[MAXPATHLEN];
    struct stat   file_info;

    if (attached)
      return;

    ow = getenv ("OPENWINHOME");
    if (ow == (char *) NULL)
      ow = DGET ("/usr/openwin");
    
    sprintf (dir1, "%s/share/images/raster", ow);
    if (stat (dir1, &file_info) == 0)
      xv_set (obj, FILE_CHOOSER_APP_DIR, LGET ("Sample Sun Raster Files"), dir1, NULL);
    
    sprintf (dir2, "%s/share/images/PostScript", ow);
    if (stat (dir2, &file_info) == 0)
      xv_set (obj, FILE_CHOOSER_APP_DIR, LGET ("Sample PostScript Files"), dir2, NULL);
    attached = TRUE;

}
#ifdef FILECHOOSER
/*
 * Initialize an instance of object `openfc'.
 */
File_chooser
OpenfcObjectsInitialize(owner)
	Xv_opaque	owner;
{
        File_chooser  obj;
        extern int    openfc_callback();

        if (!openfc) {
          obj = xv_create (owner, FILE_CHOOSER_OPEN_DIALOG,
			   XV_LABEL, LGET ("Image Tool:  Open"),
			   FILE_CHOOSER_NOTIFY_FUNC, openfc_callback,  
			   FILE_CHOOSER_DIRECTORY, NULL,
			   XV_KEY_DATA,           INSTANCE, owner,
#ifdef OW_I18N
			   WIN_USE_IM, TRUE,
#endif
			   NULL);
        }

        attach_directories (obj);

	return  obj;
}

/*
 * Initialize an instance of object `savefc'.
 */
File_chooser
SavefcObjectsInitialize(owner)
	Xv_opaque	owner;
{
        File_chooser   obj;
	extern int     savefc_callback();

        if (!savefc) {
          obj = xv_create (owner, FILE_CHOOSER_SAVE_DIALOG,
			      XV_LABEL, LGET ("Image Tool:  Save"),
			      FILE_CHOOSER_NOTIFY_FUNC, savefc_callback,
			      FILE_CHOOSER_DIRECTORY, NULL,
			      XV_KEY_DATA, INSTANCE, owner,
#ifdef OW_I18N
			      WIN_USE_IM, TRUE,
#endif
			      NULL);
        }

        attach_directories (obj);

	return obj;
}
#endif
#ifdef FILECHOOSER
/*
 * Initialize an instance of object `openasfc'.
 */
OpenasfcObjects *
OpenasfcObjectsInitialize(ip, owner)
	OpenasfcObjects	*ip;
	Xv_opaque	owner;
{
        int         extra_height, frame_height, frame_width;
        extern int  openas_resize_func();
        Xv_opaque   panel, file_list;
        Rect       *list_rect;

	if (!ip && !(ip = (OpenasfcObjects *) calloc(1, sizeof (OpenasfcObjects))))
		return (OpenasfcObjects *) NULL;
	if (!ip->openasfc)
		ip->openasfc = openasfc_openasfc_create(ip, owner);
        panel = xv_get (ip->openasfc, FRAME_CMD_PANEL);
	panel_y_gap = xv_get (panel, PANEL_ITEM_Y_GAP);
	if (!ip->format_list)
		ip->format_list = openasfc_format_list_create(ip, panel);
/*
 * Adjust frame default size
 */
        list_rect = (Rect *) xv_get (ip->format_list, XV_RECT);
	extra_height = list_rect->r_height;
	frame_height = xv_get (ip->openasfc, XV_HEIGHT);
	frame_width = xv_get (ip->openasfc, XV_WIDTH);
	xv_set (ip->openasfc, 
		XV_HEIGHT, frame_height + extra_height + panel_y_gap, 
		NULL);
/*
 * Adjust frame min size
 */
	xv_get (ip->openasfc, FRAME_MIN_SIZE, &frame_width, &frame_height);
	xv_set (ip->openasfc, FRAME_MIN_SIZE, 
		frame_width, frame_height + extra_height, NULL);

/*
 * Tell file chooser to reserve layout space for it.
 */
	xv_set (ip->openasfc,
		FILE_CHOOSER_EXTEN_FUNC,   openas_resize_func, 
		FILE_CHOOSER_EXTEN_HEIGHT, extra_height,
		NULL);
	return ip;
}

/*
 * Initialize an instance of object `openasfc'.
 */
File_chooser
openasfc_openasfc_create (ip, owner)
        OpenasfcObjects *ip;
	Xv_opaque	owner;
{
        File_chooser   obj;
        extern int     openasfc_callback();

	obj = xv_create (owner, FILE_CHOOSER_OPEN_DIALOG,
			 XV_LABEL, LGET ("Image Tool:  Open As"),
	         	 FILE_CHOOSER_NOTIFY_FUNC, openasfc_callback, 
			 FILE_CHOOSER_DIRECTORY, NULL,
			 XV_KEY_DATA, INSTANCE, owner,
#ifdef OW_I18N
			 WIN_USE_IM, TRUE,
#endif
			 NULL);
	
        attach_directories (obj);

	return obj;
}

/*
 * Initialize an instance of object `format_list'.
 */
Xv_opaque
openasfc_format_list_create (ip, owner)
        OpenasfcObjects *ip;
	Xv_opaque	owner;
{
        Xv_opaque   obj, list;
        int         list_height;

        list = xv_get (ip->openasfc, FILE_CHOOSER_CHILD,
		       FILE_CHOOSER_FILE_LIST_CHILD);
        list_height = (int) xv_get (list, PANEL_LIST_ROW_HEIGHT);

	obj = xv_create (owner, PANEL_LIST,
			 PANEL_LABEL_STRING, LGET ("File Format:"),
			 PANEL_LAYOUT, PANEL_VERTICAL,
			 PANEL_READ_ONLY, TRUE,
			 PANEL_LIST_DISPLAY_ROWS, 4,
			 PANEL_LIST_ROW_HEIGHT, list_height,
			 XV_KEY_DATA, INSTANCE, owner,
                	 XV_HELP_DATA, 	  "imagetool:OpenAsFormats",
			 NULL);

	return obj;
}

/*
 * Initialize an instance of object `saveasfc'.
 */
SaveasfcObjects *
SaveasfcObjectsInitialize(ip, owner)
	SaveasfcObjects	*ip;
	Xv_opaque	owner;
{
        int         extra_height, frame_height, frame_width;
        int         min_height, min_width, min_width2;
        extern int  saveas_resize_func();
        Xv_opaque   panel, file_list;
	Rect       *list_rect;

	if (!ip && !(ip = (SaveasfcObjects *) calloc(1, sizeof (SaveasfcObjects))))
		return (SaveasfcObjects *) NULL;
	if (!ip->saveasfc)
		ip->saveasfc = saveasfc_saveasfc_create(ip, owner);
        panel = xv_get (ip->saveasfc, FRAME_CMD_PANEL);
        panel_x_gap = xv_get (panel, PANEL_ITEM_X_GAP);
	if (!ip->format_list)
		ip->format_list = saveasfc_format_list_create(ip, panel);
	if (!ip->compression)
		ip->compression = saveasfc_compression_create(ip, panel);
	if (!ip->compression_value)
		ip->compression_value = saveasfc_compression_value_create(ip, panel);
	if (!ip->colors)
		ip->colors = saveasfc_colors_create(ip, panel);
	if (!ip->colors_value)
		ip->colors_value = saveasfc_colors_value_create(ip, panel);
/*
 * Adjust frame default size
 */
        list_rect = (Rect *) xv_get (ip->format_list, XV_RECT);
	extra_height = list_rect->r_height + 
                       xv_get (ip->compression, XV_HEIGHT) + 40;
	frame_height = xv_get (ip->saveasfc, XV_HEIGHT);
	frame_width = xv_get (ip->saveasfc, XV_WIDTH);
	xv_set (ip->saveasfc, XV_HEIGHT, frame_height + extra_height, NULL);
/*
 * Adjust frame min size.
 * Min width = enough room for compression or colors.
 */
	xv_get (ip->saveasfc, FRAME_MIN_SIZE, &min_width, &min_height);
        file_list = xv_get (ip->saveasfc, FILE_CHOOSER_CHILD, 
		       FILE_CHOOSER_FILE_LIST_CHILD);
        list_rect = (Rect *) xv_get (file_list, XV_RECT);
	min_width2 = panel_x_gap + 
                      xv_get (ip->compression, XV_WIDTH) + panel_x_gap +
                      xv_get (ip->compression_value, XV_WIDTH) + panel_x_gap +
                      xv_get (ip->colors, XV_WIDTH) + panel_x_gap +
                      xv_get (ip->colors_value, XV_WIDTH) + panel_x_gap +
                      35 + panel_x_gap;  /* fix later, but this is the right edge */
        min_width = Max (min_width2, min_width);                      
	xv_set (ip->saveasfc, FRAME_MIN_SIZE, 
		min_width, min_height + extra_height, NULL);
        if (min_width > frame_width)
          xv_set (ip->saveasfc, XV_WIDTH, min_width, NULL);
/*
 * Tell file chooser to reserve layout space for it.
 */
	xv_set (ip->saveasfc,
		FILE_CHOOSER_EXTEN_FUNC,   saveas_resize_func,
		FILE_CHOOSER_EXTEN_HEIGHT, extra_height,
		NULL);

	return ip;
}

/*
 * Initialize an instance of object `saveasfc'.
 */
File_chooser
saveasfc_saveasfc_create (ip, owner)
        SaveasfcObjects *ip;
	Xv_opaque	owner;
{
        File_chooser   obj;
        extern int     saveasfc_callback();

	obj = xv_create (owner, FILE_CHOOSER_SAVEAS_DIALOG,
			 XV_LABEL, LGET ("Image Tool:  Save As"),
			 FILE_CHOOSER_NOTIFY_FUNC, saveasfc_callback, 
			 FILE_CHOOSER_DIRECTORY, NULL,
			 XV_KEY_DATA, INSTANCE, owner,
#ifdef OW_I18N
			 WIN_USE_IM, TRUE,
#endif
			 NULL);
	
        attach_directories (obj);

	return obj;
}

/*
 * Initialize an instance of object `format_list'.
 */
Xv_opaque
saveasfc_format_list_create (ip, owner)
        SaveasfcObjects *ip;
	Xv_opaque	owner;
{
        Xv_opaque       obj, list;
        int             list_height;
	extern void     check_image_format();


        list = xv_get (ip->saveasfc, FILE_CHOOSER_CHILD,
		       FILE_CHOOSER_FILE_LIST_CHILD);
        list_height = (int) xv_get (list, PANEL_LIST_ROW_HEIGHT);
	obj = xv_create (owner, PANEL_LIST,
			 PANEL_LABEL_STRING, LGET ("File Format:"),
			 PANEL_NOTIFY_PROC, check_image_format,
			 PANEL_READ_ONLY, TRUE,
			 PANEL_LAYOUT, PANEL_VERTICAL,
			 PANEL_LIST_DISPLAY_ROWS, 4,
			 PANEL_LIST_ROW_HEIGHT, list_height,
			 XV_KEY_DATA, INSTANCE, owner,
                	 XV_HELP_DATA, 	  "imagetool:SaveAsFormats",
			 NULL);

	return obj;
}

Xv_opaque
saveasfc_compression_menu_create (ip, owner)
       SaveasfcObjects  *ip;
       Xv_opaque        owner;
{
       extern void     	saveas_compression_callback();
       Xv_opaque        obj;

       obj = xv_create (NULL, MENU_COMMAND_MENU,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_NOTIFY_PROC, saveas_compression_callback, 
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("None"),
			  XV_HELP_DATA, "imagetool:SaveAsCompression",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("Unix"),
			  XV_HELP_DATA, "imagetool:SaveAsCompression",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("Encoded"),
			  XV_HELP_DATA, "imagetool:SaveAsCompression",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("LZW"),
			  XV_HELP_DATA, "imagetool:SaveAsCompression",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("JPEG"),
			  XV_HELP_DATA, "imagetool:SaveAsCompression",
			  NULL,
			NULL);
       return obj;
}

/*
 * Initialize an instance of object `compression'.
 */
Xv_opaque
saveasfc_compression_create (ip, owner)
        SaveasfcObjects *ip;
	Xv_opaque	owner;
{
        Xv_opaque   obj;

	obj = xv_create (owner, PANEL_ABBREV_MENU_BUTTON,
			 PANEL_ITEM_MENU, saveasfc_compression_menu_create (ip, owner),
			 PANEL_LABEL_STRING, LGET ("Compression:"),
			 XV_KEY_DATA, INSTANCE, owner,
			 XV_HELP_DATA, "imagetool:SaveAsCompression",
			 NULL);

	return obj;
}



/*
 * Create object `compression_value' in the specified instance.
 */
Xv_opaque
saveasfc_compression_value_create(ip, owner)
	SaveasfcObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_MESSAGE,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, xv_get( ip->compression, XV_X ) +
		      xv_get( ip->compression, XV_WIDTH ) +
		      panel_x_gap * 2,
		XV_Y, xv_get( ip->compression, XV_Y ),
		PANEL_LABEL_BOLD, FALSE,
 		PANEL_LABEL_STRING, LGET ("Encoded"),
                XV_HELP_DATA, "imagetool:SaveAsCompression",
		NULL);
	return obj;
}

Xv_opaque
saveasfc_colors_menu_create (ip, owner)
       SaveasfcObjects  *ip;
       Xv_opaque        owner;
{
       extern void      saveas_colors_callback();
       Xv_opaque  obj;

       obj = xv_create (NULL, MENU_COMMAND_MENU,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_NOTIFY_PROC, saveas_colors_callback, 
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("B&W"),
			  XV_HELP_DATA, "imagetool:SaveAsColors",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("256"),
			  XV_HELP_DATA, "imagetool:SaveAsColors",
			  NULL,
			MENU_ITEM,
			  XV_KEY_DATA, INSTANCE, ip,
			  MENU_STRING, LGET ("Millions"),
			  XV_HELP_DATA, "imagetool:SaveAsColors",
			  NULL,
			NULL);
       return obj;
}

/*
 * Initialize an instance of object `colors'.
 */
Xv_opaque
saveasfc_colors_create (ip, owner)
        SaveasfcObjects *ip;
	Xv_opaque	owner;
{
        Xv_opaque   obj;

	obj = xv_create (owner, PANEL_ABBREV_MENU_BUTTON,
			 PANEL_ITEM_MENU, saveasfc_colors_menu_create (ip, owner),
			 PANEL_LABEL_STRING, LGET ("Colors:"),
			 XV_KEY_DATA, INSTANCE, owner,
			 XV_HELP_DATA, "imagetool:SaveAsColors",
			 NULL);


	return obj;
}

/*
 * Create object `colors_value' in the specified instance.
 */
Xv_opaque
saveasfc_colors_value_create(ip, owner)
	SaveasfcObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_MESSAGE,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, xv_get( ip->colors, XV_X ) +
		      xv_get( ip->colors, XV_WIDTH ) +
		      panel_x_gap * 2,
		XV_Y, xv_get( ip->colors, XV_Y ),
		PANEL_LABEL_BOLD, FALSE,
 		PANEL_LABEL_STRING, LGET ("Millions"),
                XV_HELP_DATA, "imagetool:SaveAsColors",
		NULL);
	return obj;
}

#endif

/*
 * Initialize an instance of object `saveas'.
 */
SaveasObjects *
SaveasObjectsInitialize(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	if (!ip && !(ip = (SaveasObjects *) calloc(1, sizeof (SaveasObjects))))
		return (SaveasObjects *) NULL;
	if (!ip->saveas)
		ip->saveas = saveas_saveas_create(ip, owner);
	if (!ip->controls)
		ip->controls = saveas_controls_create(ip, ip->saveas);
	if (!ip->format_list)
		ip->format_list = saveas_format_list_create(ip, ip->controls);
	if (!ip->depth)
		ip->depth = saveas_depth_create(ip, ip->controls);
	if (!ip->depth_value)
		ip->depth_value = saveas_depth_value_create(ip, ip->controls);
	if (!ip->compression)
		ip->compression = saveas_compression_create(ip, ip->controls);
	if (!ip->compression_value)
		ip->compression_value = saveas_compression_value_create(ip, 
							ip->controls);
	if (!ip->directory)
		ip->directory = saveas_directory_create(ip, ip->controls);
	if (!ip->file)
		ip->file = saveas_file_create(ip, ip->controls);
	if (!ip->save_button)
		ip->save_button = saveas_save_button_create(ip, ip->controls);
	if (!ip->save_selection_button)
		ip->save_selection_button = saveas_save_selection_button_create
						(ip, ip->controls);
	return ip;
}

/*
 * Create object `saveas' in the specified instance.
 */
Xv_opaque
saveas_saveas_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, FRAME_CMD,
		XV_KEY_DATA, INSTANCE, ip,
		XV_WIDTH, 370,
		XV_HEIGHT, 320,
		XV_LABEL,  LGET("Image Tool:  Save As"),
		XV_SHOW, FALSE,
		FRAME_SHOW_FOOTER, TRUE,
		FRAME_SHOW_RESIZE_CORNER, FALSE,
		FRAME_CMD_PUSHPIN_IN, FALSE,
#ifdef OW_I18N
		WIN_USE_IM, TRUE,
#endif
		NULL);
	/*xv_set(xv_get(obj, FRAME_CMD_PANEL), WIN_SHOW, FALSE, NULL);*/
	return obj;
}

/*
 * Create object `controls' in the specified instance.
 */
Xv_opaque
saveas_controls_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
        obj = xv_get( owner, FRAME_CMD_PANEL );
	xv_set( obj,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 0,
		XV_Y, 0,
		XV_WIDTH, WIN_EXTEND_TO_EDGE,
		XV_HEIGHT, WIN_EXTEND_TO_EDGE,
		WIN_BORDER, FALSE,
		XV_HELP_DATA, "imagetool:SaveAs",
		NULL);
        panel_x_gap = xv_get( obj, PANEL_ITEM_X_GAP );
        panel_y_gap = xv_get( obj, PANEL_ITEM_Y_GAP );
	return obj;
}

/*
 * Create object `format_list' in the specified instance.
 */
Xv_opaque
saveas_format_list_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	extern void     check_image_format();
	Xv_opaque	obj;
        int	        i;
	
	obj = xv_create( owner, PANEL_LIST,
		XV_KEY_DATA, INSTANCE, ip,
                PANEL_LIST_WIDTH, 200,
                PANEL_LIST_DISPLAY_ROWS, 6,
                PANEL_LIST_TITLE, LGET ("Image Formats"),
		PANEL_NOTIFY_PROC,  check_image_format,
                PANEL_LAYOUT, PANEL_VERTICAL,
                PANEL_READ_ONLY, TRUE,
                PANEL_CHOOSE_ONE, TRUE,
                PANEL_CHOOSE_NONE, TRUE,
/*
                PANEL_LIST_STRINGS,
                        "Sun Raster",
                        "Tiff",
                        "GIF",
                        "PostScript",
                        "Pict",
			"XPM",
			"IFF ILBM",
			"Atari Degas",
			"PC Paintbrush",
                        NULL,
*/
                PANEL_LIST_SELECT, 0, TRUE,
/*
 * Setting the cms doesn't seem to matter..
 */
		/*WIN_CMS, panel_cms, */
		XV_HELP_DATA, "imagetool:SaveAsFormatList",
                NULL);
	ds_center_items( owner, 1, obj, NULL );
        xv_set( obj, XV_Y, panel_y_gap, NULL );
	return obj;
}

/*
 * Create object `depth_menu' in the specified instance.
 */
Xv_opaque
saveas_depth_menu_create(ip, owner)
	caddr_t		ip;
	Xv_opaque	owner;
{
	extern void             saveas_depth_callback();
	Xv_opaque		obj;
	
	obj = xv_create(XV_NULL, MENU_COMMAND_MENU,
		XV_KEY_DATA, INSTANCE, ip,
		MENU_NOTIFY_PROC, saveas_depth_callback,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("B/W"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
/*
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("4"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
*/
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("8"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("24"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("32"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
/*
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("Encapsulated PostScript File"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("Complete PostScript File"),
			XV_HELP_DATA, "imagetool:SaveAsDepth",
			NULL,
*/
		NULL);
	return obj;
}

/*
 * Create object `depth' in the specified instance.
 */
Xv_opaque
saveas_depth_create(ip, owner)
	SaveasObjects *ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_ABBREV_MENU_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
                PANEL_ITEM_MENU, saveas_depth_menu_create(),
		PANEL_LABEL_STRING, LGET ("Color Depth:"),
		XV_X, 20,
		XV_Y, xv_get( ip->format_list, XV_Y ) +
			      xv_get( ip->format_list, XV_HEIGHT ) +
			      panel_y_gap,
		XV_HELP_DATA,  "imagetool:SaveAsDepth",
		NULL);
	return obj;
}

/*
 * Create object `depth_value' in the specified instance.
 */
Xv_opaque
saveas_depth_value_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_MESSAGE,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, xv_get( ip->depth, XV_X ) +
		      xv_get( ip->depth, XV_WIDTH ) +
		      panel_x_gap,
		XV_Y, xv_get( ip->depth, XV_Y ),
		PANEL_LABEL_BOLD, FALSE,
 		PANEL_LABEL_STRING, LGET ("8"),
                XV_HELP_DATA, "imagetool:SaveAsDepth",
		NULL);
	return obj;
}

/*
 * Create object `compression_menu' in the specified instance.
 */
Xv_opaque
saveas_compression_menu_create(ip, owner)
	caddr_t		ip;
	Xv_opaque	owner;
{
	extern void     	saveas_compression_callback();
	Xv_opaque		obj;
	
	obj = xv_create(XV_NULL, MENU_COMMAND_MENU,
		XV_KEY_DATA, INSTANCE, ip,
		MENU_NOTIFY_PROC, saveas_compression_callback,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("None"),
			XV_HELP_DATA, "imagetool:SaveAsCompression",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("Unix"),
			XV_HELP_DATA, "imagetool:SaveAsCompression",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("Encoded"),
			XV_HELP_DATA, "imagetool:SaveAsCompression",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("LZW"),
			XV_HELP_DATA, "imagetool:SaveAsCompression",
			NULL,
		MENU_ITEM,
			XV_KEY_DATA, INSTANCE, ip,
			MENU_STRING, LGET ("JPEG"),
			XV_HELP_DATA, "imagetool:SaveAsCompression",
			NULL,
		NULL);
	return obj;
}

/*
 * Create object `compression' in the specified instance.
 */
Xv_opaque
saveas_compression_create(ip, owner)
	SaveasObjects *ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_ABBREV_MENU_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
		PANEL_ITEM_MENU, saveas_compression_menu_create(),
		PANEL_LABEL_STRING, LGET ("Compression:"),
		XV_X, panel_x_gap,
		XV_Y, xv_get( ip->depth, XV_Y ) +
		      xv_get( ip->depth, XV_HEIGHT ) +
		      panel_y_gap,
		XV_HELP_DATA,  "imagetool:SaveAsCompression",
		NULL);
	return obj;
}

/*
 * Create object `compression_value' in the specified instance.
 */
Xv_opaque
saveas_compression_value_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_MESSAGE,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, xv_get( ip->compression, XV_X ) +
		      xv_get( ip->compression, XV_WIDTH ) +
		      panel_x_gap,
		XV_Y, xv_get( ip->compression, XV_Y ),
		PANEL_LABEL_BOLD, FALSE,
 		PANEL_LABEL_STRING, LGET ("None"),
                XV_HELP_DATA, "imagetool:SaveAsCompression",
		NULL);
	return obj;
}

/*
 * Create object `directory' in the specified instance.
 */
Xv_opaque
saveas_directory_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 38,
		XV_Y, xv_get( ip->compression, XV_Y ) +
		      xv_get( ip->compression, XV_HEIGHT ) +
	 	      panel_y_gap,
		PANEL_VALUE_DISPLAY_LENGTH, 30,
		PANEL_VALUE_STORED_LENGTH, MAXPATHLEN,
		PANEL_LABEL_STRING, LGET ("Directory:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
		XV_HELP_DATA, "imagetool:SaveAsDirectory",
		NULL);
	return obj;
}

/*
 * Create object `file' in the specified instance.
 */
Xv_opaque
saveas_file_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 77,
		XV_Y, xv_get( ip->directory, XV_Y ) +
		      xv_get( ip->directory, XV_HEIGHT ) +
	 	      panel_y_gap,
		PANEL_VALUE_DISPLAY_LENGTH, 30,
		PANEL_VALUE_STORED_LENGTH, 80,
		PANEL_LABEL_STRING, LGET ("File:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
		XV_HELP_DATA, "imagetool:SaveAsFile",
		NULL);
	return obj;
}

/*
 * Create object `save_button' in the specified instance.
 */
Xv_opaque
saveas_save_button_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	extern void	saveas_file ();
	
	obj = xv_create(owner, PANEL_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
		PANEL_LABEL_STRING, LGET ("Save"),
		XV_HELP_DATA, "imagetool:SaveAsSaveButton",
		PANEL_NOTIFY_PROC, saveas_file,
		NULL);
	ds_center_items( owner, 1, obj, NULL );
        xv_set( obj, XV_Y, xv_get( ip->file, XV_Y ) +
			   xv_get( ip->file, XV_HEIGHT ) +
			   panel_y_gap,
		NULL );
	return obj;
}

/*
 * Create object `save_selection_button' in the specified instance.
 */
Xv_opaque
saveas_save_selection_button_create(ip, owner)
	SaveasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	extern void	saveselectionas_file ();
	
	obj = xv_create(owner, PANEL_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
		PANEL_LABEL_STRING, LGET ("Save Selection"),
		XV_HELP_DATA, "imagetool:SaveAsSaveSelectionButton",
		PANEL_NOTIFY_PROC, saveselectionas_file,
		XV_SHOW, FALSE,
		NULL);
	ds_center_items( owner, 1, obj, NULL );
        xv_set( obj, XV_Y, xv_get( ip->file, XV_Y ) +
			   xv_get( ip->file, XV_HEIGHT ) +
			   panel_y_gap,
		NULL );
	return obj;
}

/*
 * Initialize an instance of object `openas'.
 */
OpenasObjects *
OpenasObjectsInitialize(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	if (!ip && !(ip = (OpenasObjects *) calloc(1, sizeof (OpenasObjects))))
		return (OpenasObjects *) NULL;
	if (!ip->openas)
		ip->openas = openas_openas_create(ip, owner);
	if (!ip->controls)
		ip->controls = openas_controls_create(ip, ip->openas);
	if (!ip->format_list)
		ip->format_list = openas_format_list_create(ip, ip->controls);
	if (!ip->directory)
		ip->directory = openas_directory_create(ip, ip->controls);
	if (!ip->file)
		ip->file = openas_file_create(ip, ip->controls);
	if (!ip->open_button)
		ip->open_button = openas_open_button_create(ip, ip->controls);
	return ip;
}

/*
 * Create object `openas' in the specified instance.
 */
Xv_opaque
openas_openas_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, FRAME_CMD,
		XV_KEY_DATA, INSTANCE, ip,
		XV_WIDTH, 350,
		XV_HEIGHT, 265,
		XV_LABEL, LGET("Image Tool:  Open As"),
		XV_SHOW, FALSE,
		FRAME_SHOW_FOOTER, TRUE,
		FRAME_SHOW_RESIZE_CORNER, FALSE,
		FRAME_CMD_PUSHPIN_IN, FALSE,
#ifdef OW_I18N
		WIN_USE_IM, TRUE,
#endif
		NULL);
	/*xv_set(xv_get(obj, FRAME_CMD_PANEL), WIN_SHOW, FALSE, NULL);*/
	return obj;
}

/*
 * Create object `controls' in the specified instance.
 */
Xv_opaque
openas_controls_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
        obj = xv_get( owner, FRAME_CMD_PANEL );
	xv_set( obj,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 0,
		XV_Y, 0,
		XV_WIDTH, WIN_EXTEND_TO_EDGE,
		XV_HEIGHT, WIN_EXTEND_TO_EDGE,
		WIN_BORDER, FALSE,
		XV_HELP_DATA, "imagetool:OpenAs",
		NULL);
        panel_x_gap = xv_get( obj, PANEL_ITEM_X_GAP );
        panel_y_gap = xv_get( obj, PANEL_ITEM_Y_GAP );
	return obj;
}

/*
 * Create object `format_list' in the specified instance.
 */
Xv_opaque
openas_format_list_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
        int	        i;
	
	obj = xv_create( owner, PANEL_LIST,
		XV_KEY_DATA, INSTANCE, ip,
                PANEL_LIST_WIDTH, 200,
                PANEL_LIST_DISPLAY_ROWS, 6,
                PANEL_LIST_TITLE, LGET ("Image Formats"),
                PANEL_LAYOUT, PANEL_VERTICAL,
                PANEL_READ_ONLY, TRUE,
                PANEL_CHOOSE_NONE, TRUE,
/*
                PANEL_LIST_STRINGS,
                        "Sun Raster",
                        "Tiff",
                        "GIF",
                        "PostScript",
                        "Pict",
			"XPM",
			"IFF ILBM",
			"Atari Degas",
			"PC Paintbrush",
                        NULL,
*/
		XV_HELP_DATA, "imagetool:OpenAsFormatList",
                NULL);
	ds_center_items( owner, 1, obj, NULL );
        xv_set( obj, XV_Y, panel_y_gap, NULL );
	return obj;
}

/*
 * Create object `directory' in the specified instance.
 */
Xv_opaque
openas_directory_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 16,
		XV_Y, xv_get( ip->format_list, XV_Y ) +
		      xv_get( ip->format_list, XV_HEIGHT ) +
	 	      panel_y_gap,
		PANEL_VALUE_DISPLAY_LENGTH, 30,
		PANEL_VALUE_STORED_LENGTH, MAXPATHLEN,
		PANEL_LABEL_STRING, LGET ("Directory:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
		XV_HELP_DATA, "imagetool:OpenAsDirectory",
		NULL);
	return obj;
}

/*
 * Create object `file' in the specified instance.
 */
Xv_opaque
openas_file_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	extern void	openas_file ();
	Xv_opaque	obj;
	
	obj = xv_create(owner, PANEL_TEXT,
		XV_KEY_DATA, INSTANCE, ip,
		XV_X, 56,
		XV_Y, xv_get( ip->directory, XV_Y ) +
		      xv_get( ip->directory, XV_HEIGHT ) +
	 	      panel_y_gap,
		PANEL_VALUE_DISPLAY_LENGTH, 30,
		PANEL_VALUE_STORED_LENGTH, 80,
		PANEL_LABEL_STRING, LGET ("File:"),
		PANEL_LAYOUT, PANEL_HORIZONTAL,
		PANEL_READ_ONLY, FALSE,
		PANEL_NOTIFY_LEVEL, PANEL_SPECIFIED,
		PANEL_NOTIFY_STRING, "\r\n",
		PANEL_NOTIFY_PROC, openas_file,
		XV_HELP_DATA, "imagetool:OpenAsFile",
		NULL);
	return obj;
}

/*
 * Create object `open_button' in the specified instance.
 */
Xv_opaque
openas_open_button_create(ip, owner)
	OpenasObjects	*ip;
	Xv_opaque	owner;
{
	Xv_opaque	obj;
	extern void	openas_file ();
	
	obj = xv_create(owner, PANEL_BUTTON,
		XV_KEY_DATA, INSTANCE, ip,
		PANEL_LABEL_STRING, LGET ("Open"),
		XV_HELP_DATA, "imagetool:OpenAsOpenButton",
		PANEL_NOTIFY_PROC, openas_file,
		NULL);
	ds_center_items( owner, 1, obj, NULL );
        xv_set( obj, XV_Y, xv_get( ip->file, XV_Y ) +
			   xv_get( ip->file, XV_HEIGHT ) +
			   panel_y_gap,
		NULL );
	return obj;
}

